<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Cricket Tournament 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: #667eea;
        }

        .tab-btn.active {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Stage Headers */
        .stage-header {
            background: linear-gradient(135deg, #5568d3 0%, #6b46c1 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-size: 1.5em;
            font-weight: bold;
            text-align: left;
        }

        /* Match Card */
        .match-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 0;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .match-header {
            background: #f3f4f6;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e5e7eb;
        }

        .match-id {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
        }

        .match-time {
            color: #666;
            font-size: 1em;
        }

        /* Teams Section */
        .teams-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 0;
            padding: 20px;
        }

        .team-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 12px;
            color: white;
        }

        .team-name-input {
            width: 100%;
            padding: 12px;
            font-size: 1.3em;
            font-weight: bold;
            border: 2px solid white;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.95);
            color: #667eea;
        }

        .score-input {
            width: 100%;
            padding: 15px;
            font-size: 1.5em;
            font-weight: bold;
            border: 2px solid white;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 10px;
            background: white;
        }

        .overs-input {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            border: 2px solid white;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 10px;
            background: white;
        }

        .run-rate {
            background: #fbbf24;
            color: #000;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.2em;
            text-align: center;
        }

        .vs-divider {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            padding: 0 30px;
        }

        /* Player Sections */
        .players-container {
            padding: 20px;
            background: #f9fafb;
            border-top: 2px solid #e5e7eb;
        }

        .player-section {
            margin-bottom: 20px;
        }

        .player-section-title {
            color: #667eea;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .add-player-btn {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: background 0.3s;
        }

        .add-player-btn:hover {
            background: #5568d3;
        }

        /* Action Buttons */
        .action-btn {
            width: 100%;
            padding: 18px;
            background: #9ca3af;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .action-btn.enabled {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .action-btn.enabled:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        /* Winner Badge */
        .winner-badge {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.3em;
            text-align: center;
            margin: 20px;
        }

        /* Champion Banner */
        .champion-banner {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #000;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            margin: 20px;
            box-shadow: 0 10px 30px rgba(251, 191, 36, 0.5);
        }

        /* Standings Table */
        .standings-table {
            width: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .standings-table th {
            background: #667eea;
            color: white;
            padding: 18px;
            text-align: left;
            font-size: 1.1em;
        }

        .standings-table td {
            padding: 18px;
            border-bottom: 1px solid #e5e7eb;
            font-size: 1.05em;
        }

        .standings-table tr:hover {
            background: #f3f4f6;
        }

        /* Players Stats Page */
        .stats-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .stats-section {
            margin-bottom: 40px;
        }

        .stats-title {
            background: #667eea;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .stats-table {
            width: 100%;
            border-collapse: collapse;
        }

        .stats-table th {
            background: #f3f4f6;
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #667eea;
            font-weight: bold;
            color: #667eea;
        }

        .stats-table td {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
        }

        .stats-table tr:hover {
            background: #f9fafb;
        }

        .team-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.9em;
            color: white;
        }

        @media (max-width: 968px) {
            .teams-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .vs-divider {
                padding: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèè ROYAL CRICKET TOURNAMENT 2025 üèÜ</h1>
            <p>üìÖ Date: 28/12/2025</p>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('league', event)">League Matches</button>
            <button class="tab-btn" onclick="showTab('knockout', event)">Knockout Stage</button>
            <button class="tab-btn" onclick="showTab('standings', event)">Standings</button>
            <button class="tab-btn" onclick="showTab('playerstats', event)">Player Stats</button>
        </div>

        <!-- League Matches Tab -->
        <div id="league" class="tab-content active">
            <div class="stage-header">Stage 1 - League Matches</div>
            <div id="leagueMatches"></div>
            <button class="action-btn" id="setupKnockoutBtn" onclick="setupKnockout()">Complete League Stage & Setup Quarter Final</button>
        </div>

        <!-- Knockout Stage Tab -->
        <div id="knockout" class="tab-content">
            <div class="stage-header">Quarter Final (Eliminator)</div>
            <div id="qfMatch"></div>
            <button class="action-btn" id="setupSFBtn" onclick="setupSemiFinal()">Setup Semi-Final</button>

            <div class="stage-header" style="margin-top: 30px;">Semi Final</div>
            <div id="sfMatch"></div>
            <button class="action-btn" id="setupFinalBtn" onclick="setupFinal()">Setup Grand Final</button>

            <div class="stage-header" style="margin-top: 30px;">üèÜ Grand Final üèÜ</div>
            <div id="finalMatch"></div>
        </div>

        <!-- Standings Tab -->
        <div id="standings" class="tab-content">
            <div class="stage-header">League Standings</div>
            <table class="standings-table">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Team</th>
                        <th>Played</th>
                        <th>Won</th>
                        <th>Lost</th>
                        <th>Points</th>
                    </tr>
                </thead>
                <tbody id="standingsBody"></tbody>
            </table>
        </div>

        <!-- Player Stats Tab -->
        <div id="playerstats" class="tab-content">
            <div class="stats-container">
                <div class="stats-section">
                    <div class="stats-title">üèè Top Batsmen - Runs Scored</div>
                    <table class="stats-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Player</th>
                                <th>Team</th>
                                <th>Runs</th>
                                <th>Balls</th>
                                <th>Strike Rate</th>
                            </tr>
                        </thead>
                        <tbody id="batsmenStats"></tbody>
                    </table>
                </div>

                <div class="stats-section">
                    <div class="stats-title">‚öæ Top Bowlers - Wickets Taken</div>
                    <table class="stats-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Player</th>
                                <th>Team</th>
                                <th>Wickets</th>
                                <th>Overs</th>
                                <th>Economy</th>
                            </tr>
                        </thead>
                        <tbody id="bowlersStats"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        let teams = {
            RW: { name: 'Royal Warriors', color: '#3b82f6' },
            RG: { name: 'Royal Gladiators', color: '#ef4444' },
            RS: { name: 'Royal Spartans', color: '#10b981' },
            RC: { name: 'Royal Challengers', color: '#8b5cf6' }
        };

        let matches = {
            league: [
                { id: 'L1', time: '8:00 - 9:30 AM', team1: 'RW', team2: 'RG', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] },
                { id: 'L2', time: '9:45 - 11:15 AM', team1: 'RS', team2: 'RC', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] },
                { id: 'L3', time: '11:30 - 1:00 PM', team1: 'RW', team2: 'RS', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] },
                { id: 'L4', time: '1:45 - 3:15 PM', team1: 'RG', team2: 'RC', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] },
                { id: 'L5', time: '3:30 - 5:00 PM', team1: 'RW', team2: 'RC', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] },
                { id: 'L6', time: '5:15 - 6:45 PM', team1: 'RG', team2: 'RS', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] }
            ],
            qf: { id: 'QF', time: '7:00 - 8:00 PM', team1: '', team2: '', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] },
            sf: { id: 'SF', time: '8:15 - 9:15 PM', team1: '', team2: '', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] },
            final: { id: 'FINAL', time: '9:30 - 10:45 PM', team1: '', team2: '', score1: '', score2: '', overs1: '', overs2: '', winner: '', batsmen1: [], bowlers1: [], batsmen2: [], bowlers2: [] }
        };

        function updateTeamName(teamId, newName) {
            teams[teamId].name = newName;
            renderAll();
        }

        function calculateRunRate(score, overs) {
            if (!score || !overs || overs == 0) return '0.00';
            return (parseFloat(score) / parseFloat(overs)).toFixed(2);
        }

        function updateMatch(matchId, field, value) {
            const match = matches.league.find(m => m.id === matchId);
            if (match) {
                match[field] = value;
                if (match.score1 && match.score2) {
                    match.winner = parseInt(match.score1) > parseInt(match.score2) ? match.team1 : match.team2;
                }
                renderAll();
            }
        }

        function updateKnockoutMatch(stage, field, value) {
            matches[stage][field] = value;
            if (matches[stage].score1 && matches[stage].score2) {
                matches[stage].winner = parseInt(matches[stage].score1) > parseInt(matches[stage].score2) 
                    ? matches[stage].team1 : matches[stage].team2;
            }
            renderAll();
        }

        function addPlayer(matchId, team, type) {
            const match = matches.league.find(m => m.id === matchId) || matches[matchId.toLowerCase()];
            if (match) {
                const arrayName = type === 'batsman' ? `batsmen${team}` : `bowlers${team}`;
                if (type === 'batsman') {
                    match[arrayName].push({ name: '', runs: '', balls: '' });
                } else {
                    match[arrayName].push({ name: '', wickets: '', overs: '', runsConceded: '' });
                }
                renderAll();
            }
        }

        function updatePlayer(matchId, team, type, index, field, value) {
            const match = matches.league.find(m => m.id === matchId) || matches[matchId.toLowerCase()];
            if (match) {
                const arrayName = type === 'batsman' ? `batsmen${team}` : `bowlers${team}`;
                match[arrayName][index][field] = value;
                renderPlayerStats();
            }
        }

        function createMatchCard(match, isKnockout = false) {
            const rr1 = calculateRunRate(match.score1, match.overs1);
            const rr2 = calculateRunRate(match.score2, match.overs2);
            const team1Name = teams[match.team1]?.name || 'TBD';
            const team2Name = teams[match.team2]?.name || 'TBD';

            return `
                <div class="match-card">
                    <div class="match-header">
                        <span class="match-id">${match.id}</span>
                        <span class="match-time">‚è∞ ${match.time}</span>
                    </div>
                    
                    <div class="teams-container">
                        <div class="team-section">
                            ${match.team1 ? `
                                <input type="text" class="team-name-input" 
                                    value="${team1Name}" 
                                    onchange="updateTeamName('${match.team1}', this.value)">
                            ` : '<div class="team-name-input">TBD</div>'}
                            <input type="number" class="score-input" placeholder="Score" 
                                value="${match.score1}" 
                                onchange="${isKnockout ? `updateKnockoutMatch('${match.id.toLowerCase()}', 'score1', this.value)` : `updateMatch('${match.id}', 'score1', this.value)`}">
                            <input type="number" step="0.1" class="overs-input" placeholder="Overs" 
                                value="${match.overs1}" 
                                onchange="${isKnockout ? `updateKnockoutMatch('${match.id.toLowerCase()}', 'overs1', this.value)` : `updateMatch('${match.id}', 'overs1', this.value)`}">
                            <div class="run-rate">RR: ${rr1}</div>
                        </div>
                        
                        <div class="vs-divider">VS</div>
                        
                        <div class="team-section">
                            ${match.team2 ? `
                                <input type="text" class="team-name-input" 
                                    value="${team2Name}" 
                                    onchange="updateTeamName('${match.team2}', this.value)">
                            ` : '<div class="team-name-input">TBD</div>'}
                            <input type="number" class="score-input" placeholder="Score" 
                                value="${match.score2}" 
                                onchange="${isKnockout ? `updateKnockoutMatch('${match.id.toLowerCase()}', 'score2', this.value)` : `updateMatch('${match.id}', 'score2', this.value)`}">
                            <input type="number" step="0.1" class="overs-input" placeholder="Overs" 
                                value="${match.overs2}" 
                                onchange="${isKnockout ? `updateKnockoutMatch('${match.id.toLowerCase()}', 'overs2', this.value)` : `updateMatch('${match.id}', 'overs2', this.value)`}">
                            <div class="run-rate">RR: ${rr2}</div>
                        </div>
                    </div>

                    ${match.winner ? `<div class="winner-badge">üèÜ Winner: ${teams[match.winner]?.name || match.winner}</div>` : ''}

                    <div class="players-container">
                        <div class="player-section">
                            <div class="player-section-title">üèè ${team1Name} Batsmen</div>
                            ${match.batsmen1.map((b, i) => `
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                    <input type="text" placeholder="Name" value="${b.name}" 
                                        onchange="updatePlayer('${match.id}', '1', 'batsman', ${i}, 'name', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" placeholder="Runs" value="${b.runs}" 
                                        onchange="updatePlayer('${match.id}', '1', 'batsman', ${i}, 'runs', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" placeholder="Balls" value="${b.balls}" 
                                        onchange="updatePlayer('${match.id}', '1', 'batsman', ${i}, 'balls', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                </div>
                            `).join('')}
                            <button class="add-player-btn" onclick="addPlayer('${match.id}', '1', 'batsman')">+ Add Batsman</button>
                        </div>

                        <div class="player-section" style="margin-top: 20px;">
                            <div class="player-section-title">‚öæ ${team1Name} Bowlers</div>
                            ${match.bowlers1.map((b, i) => `
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                    <input type="text" placeholder="Name" value="${b.name}" 
                                        onchange="updatePlayer('${match.id}', '1', 'bowler', ${i}, 'name', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" placeholder="Wickets" value="${b.wickets}" 
                                        onchange="updatePlayer('${match.id}', '1', 'bowler', ${i}, 'wickets', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" step="0.1" placeholder="Overs" value="${b.overs}" 
                                        onchange="updatePlayer('${match.id}', '1', 'bowler', ${i}, 'overs', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" placeholder="Runs" value="${b.runsConceded}" 
                                        onchange="updatePlayer('${match.id}', '1', 'bowler', ${i}, 'runsConceded', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                </div>
                            `).join('')}
                            <button class="add-player-btn" onclick="addPlayer('${match.id}', '1', 'bowler')">+ Add Bowler</button>
                        </div>

                        <div class="player-section" style="margin-top: 20px;">
                            <div class="player-section-title">üèè ${team2Name} Batsmen</div>
                            ${match.batsmen2.map((b, i) => `
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                    <input type="text" placeholder="Name" value="${b.name}" 
                                        onchange="updatePlayer('${match.id}', '2', 'batsman', ${i}, 'name', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" placeholder="Runs" value="${b.runs}" 
                                        onchange="updatePlayer('${match.id}', '2', 'batsman', ${i}, 'runs', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" placeholder="Balls" value="${b.balls}" 
                                        onchange="updatePlayer('${match.id}', '2', 'batsman', ${i}, 'balls', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                </div>
                            `).join('')}
                            <button class="add-player-btn" onclick="addPlayer('${match.id}', '2', 'batsman')">+ Add Batsman</button>
                        </div>

                        <div class="player-section" style="margin-top: 20px;">
                            <div class="player-section-title">‚öæ ${team2Name} Bowlers</div>
                            ${match.bowlers2.map((b, i) => `
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                    <input type="text" placeholder="Name" value="${b.name}" 
                                        onchange="updatePlayer('${match.id}', '2', 'bowler', ${i}, 'name', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" placeholder="Wickets" value="${b.wickets}" 
                                        onchange="updatePlayer('${match.id}', '2', 'bowler', ${i}, 'wickets', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" step="0.1" placeholder="Overs" value="${b.overs}" 
                                        onchange="updatePlayer('${match.id}', '2', 'bowler', ${i}, 'overs', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                    <input type="number" placeholder="Runs" value="${b.runsConceded}" 
                                        onchange="updatePlayer('${match.id}', '2', 'bowler', ${i}, 'runsConceded', this.value)"
                                        style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                                </div>
                            `).join('')}
                            <button class="add-player-btn" onclick="addPlayer('${match.id}', '2', 'bowler')">+ Add Bowler</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderLeagueMatches() {
            document.getElementById('leagueMatches').innerHTML = matches.league.map(m => createMatchCard(m)).join('');
            
            const allComplete = matches.league.every(m => m.winner);
            const btn = document.getElementById('setupKnockoutBtn');
            if (allComplete) {
                btn.classList.add('enabled');
            } else {
                btn.classList.remove('enabled');
            }
        }

        function renderKnockout() {
            if (matches.qf.team1) {
                document.getElementById('qfMatch').innerHTML = createMatchCard(matches.qf, true);
                const btn = document.getElementById('setupSFBtn');
                if (matches.qf.winner) {
                    btn.classList.add('enabled');
                } else {
                    btn.classList.remove('enabled');
                }
            }
            
            if (matches.sf.team1) {
                document.getElementById('sfMatch').innerHTML = createMatchCard(matches.sf, true);
                const btn = document.getElementById('setupFinalBtn');
                if (matches.sf.winner) {
                    btn.classList.add('enabled');
                } else {
                    btn.classList.remove('enabled');
                }
            }
            
            if (matches.final.team1) {
                document.getElementById('finalMatch').innerHTML = createMatchCard(matches.final, true);
                if (matches.final.winner) {
                    document.getElementById('finalMatch').innerHTML += `
                        <div class="champion-banner">
                            üèÜ TOURNAMENT CHAMPION: ${teams[matches.final.winner]?.name || matches.final.winner} üèÜ
                        </div>
                    `;
                }
            }
        }

        function calculateStandings() {
            const standings = Object.keys(teams).map(id => ({
                id, name: teams[id].name, played: 0, won: 0, lost: 0, points: 0
            }));

            matches.league.forEach(match => {
                if (match.winner) {
                    const t1 = standings.find(t => t.id === match.team1);
                    const t2 = standings.find(t => t.id === match.team2);
                    t1.played++; t2.played++;
                    if (match.winner === match.team1) {
                        t1.won++; t1.points += 2; t2.lost++;
                    } else {
                        t2.won++; t2.points += 2; t1.lost++;
                    }
                }
            });

            return standings.sort((a, b) => b.points - a.points || b.won - a.won);
        }

        function updateStandings() {
            const standings = calculateStandings();
            document.getElementById('standingsBody').innerHTML = standings.map((team, idx) => `
                <tr>
                    <td><strong>${idx + 1}</strong></td>
                    <td><strong>${team.name}</strong></td>
                    <td>${team.played}</td>
                    <td>${team.won}</td>
                    <td>${team.lost}</td>
                    <td><strong style="color: #fbbf24;">${team.points}</strong></td>
                </tr>
            `).join('');
        }

        function renderPlayerStats() {
            const allBatsmen = [];
            const allBowlers = [];

            [...matches.league, matches.qf, matches.sf, matches.final].forEach(match => {
                if (match.team1) {
                    match.batsmen1.forEach(b => {
                        if (b.name && b.runs) {
                            allBatsmen.push({ ...b, team: match.team1 });
                        }
                    });
                    match.bowlers1.forEach(b => {
                        if (b.name && b.wickets) {
                            allBowlers.push({ ...b, team: match.team1 });
                        }
                    });
                }
                if (match.team2) {
                    match.batsmen2.forEach(b => {
                        if (b.name && b.runs) {
                            allBatsmen.push({ ...b, team: match.team2 });
                        }
                    });
                    match.bowlers2.forEach(b => {
                        if (b.name && b.wickets) {
                            allBowlers.push({ ...b, team: match.team2 });
                        }
                    });
                }
            });

            const sortedBatsmen = allBatsmen.sort((a, b) => parseInt(b.runs) - parseInt(a.runs));
            const sortedBowlers = allBowlers.sort((a, b) => parseInt(b.wickets) - parseInt(a.wickets));

            document.getElementById('batsmenStats').innerHTML = sortedBatsmen.map((b, i) => {
                const sr = b.balls > 0 ? ((b.runs / b.balls) * 100).toFixed(2) : '0.00';
                return `
                    <tr>
                        <td><strong>${i + 1}</strong></td>
                        <td>${b.name}</td>
                        <td><span class="team-badge" style="background: ${teams[b.team]?.color}">${teams[b.team]?.name}</span></td>
                        <td><strong>${b.runs}</strong></td>
                        <td>${b.balls}</td>
                        <td>${sr}</td>
                    </tr>
                `;
            }).join('') || '<tr><td colspan="6" style="text-align: center; padding: 20px; color: #999;">No batsmen data available</td></tr>';

            document.getElementById('bowlersStats').innerHTML = sortedBowlers.map((b, i) => {
                const economy = b.overs > 0 ? (b.runsConceded / b.overs).toFixed(2) : '0.00';
                return `
                    <tr>
                        <td><strong>${i + 1}</strong></td>
                        <td>${b.name}</td>
                        <td><span class="team-badge" style="background: ${teams[b.team]?.color}">${teams[b.team]?.name}</span></td>
                        <td><strong>${b.wickets}</strong></td>
                        <td>${b.overs}</td>
                        <td>${economy}</td>
                    </tr>
                `;
            }).join('') || '<tr><td colspan="6" style="text-align: center; padding: 20px; color: #999;">No bowlers data available</td></tr>';
        }

        function renderAll() {
            renderLeagueMatches();
            renderKnockout();
            updateStandings();
            renderPlayerStats();
        }

        function setupKnockout() {
            const allComplete = matches.league.every(m => m.winner);
            if (!allComplete) {
                alert("Please complete all league matches by entering scores for both teams.");
                return;
            }
            const standings = calculateStandings();
            if (standings.length >= 4) {
                matches.qf.team1 = standings[2].id;
                matches.qf.team2 = standings[3].id;
                renderAll();
                showTab('knockout', document.querySelector('[data-tab="knockout"]'));
            }
        }

        function setupSemiFinal() {
            if (!matches.qf.winner) {
                alert("Please complete the Quarter Final match by entering scores.");
                return;
            }
            const standings = calculateStandings();
            matches.sf.team1 = standings[0].id;
            matches.sf.team2 = matches.qf.winner;
            renderAll();
        }

        function setupFinal() {
            if (!matches.sf.winner) {
                alert("Please complete the Semi Final match by entering scores.");
                return;
            }
            const standings = calculateStandings();
            matches.final.team1 = matches.sf.winner;
            matches.final.team2 = standings[1].id;
            renderAll();
        }

        function showTab(tab, event) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            if (event) {
                event.target.classList.add('active');
            } else {
                // If no event is provided (like when called programmatically),
                // find and activate the corresponding tab button
                const buttons = document.querySelectorAll('.tab-btn');
                for (let btn of buttons) {
                    if (btn.getAttribute('onclick').includes(tab)) {
                        btn.classList.add('active');
                        break;
                    }
                }
            }
        }

        renderAll();
    </script>
</body>
</html>